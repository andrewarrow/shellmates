  
  useradd -r -s /bin/false fc_user
  rm -rf /srv/jailer/firecracker
  JAIL_ROOT="/srv/jailer/firecracker/hello-fc/root"
  mkdir -p ${JAIL_ROOT}/rootfs
cat > ${JAIL_ROOT}/vm_config.json << `EOF`
{
  "boot-source": {
    "kernel_image_path": "vmlinux-6.1.102",
    "boot_args": "console=ttyS0 reboot=k panic=1 pci=off"
  },
  "drives": [
    {
      "drive_id": "rootfs",
      "path_on_host": "/rootfs/ubuntu-24.04.ext4",
      "is_root_device": true,
      "is_read_only": false
    }
  ],
  "network-interfaces": [
    {
      "iface_id": "net1",
      "guest_mac": "06:00:AC:10:00:02",
      "host_dev_name": "tap0"
    }
  ],
  "machine-config": {
    "vcpu_count": 2,
    "mem_size_mib": 32768,
    "smt": false
  }
}
`EOF`

  CONFIG_FILE="${JAIL_ROOT}/vm_config.json"
  cp vmlinux-6.1.102 ${JAIL_ROOT}
  cp ubuntu-24.04.ext4 ${JAIL_ROOT}/rootfs
  cp ubuntu-24.04.id_rsa ${JAIL_ROOT}/rootfs
  chown -R fc_user:fc_user ${JAIL_ROOT}/rootfs
  jailer --id hello-fc --uid $(id -u fc_user) --gid $(id -g fc_user) --chroot-base-dir /srv/jailer --exec-file /usr/local/bin/firecracker -- --api-sock /run/api.sock --config-file ${CONFIG_FILE}
